# Test regexp https://rubular.com/r/kVdxhub23AbVMj 
# echo [2022-09-03 07:10:10Z] [INF] [a7997777] [DRN] [N/A] 123775test logs>>F:\storage\logs\api-2022-09-14.log
[PARSER]
    Name api-salesrun
    Format regex
    Regex ^\[(?<timestamp>[^\]]*)Z\] \[(?<level>[A-Z]*)\] \[(?<request_id>[a-zA-Z0-9:]*)\] \[(?<tenant>[A-Z\/]*)\] \[(?<scope>.*)\] (?<message>.*)$
    Time_Key timestamp
    Time_Format %Y-%m-%d %H:%M:%S

[PARSER]
    Name cli-salesrun
    Format regex
    Regex ^\[(?<timestamp>[^\]]*)Z\] \[(?<level>[A-Z]*)\] \[(?<request_id>[a-zA-Z0-9:]*)\] \[(?<tenant>[A-Z\/]*)\] \[(?<scope>.*)\] (?<message>.*)$
    Time_Key timestamp
    Time_Format %Y-%m-%d %H:%M:%S

[PARSER]
    Name migrator-salesrun
    Format regex
    Regex ^\[(?<timestamp>[^\]]*)Z\] \[(?<level>[A-Z]*)\] \[(?<request_id>[a-zA-Z0-9:]*)\] \[(?<tenant>[A-Z\/]*)\] \[(?<scope>.*)\] (?<message>.*)$
    Time_Key timestamp
    Time_Format %Y-%m-%d %H:%M:%S

[PARSER]
    Name        rfc5424
    Format      regex
    Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*)\]|-)) (?<message>.+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name        rfc3164-local
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        rfc3164
    Format      regex
    Regex       /^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$/
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
